{% include web/header.html %}

<h3>Customers and contacts list</h3>

<table id="customer_table" border="1">

<a href="/customer?action=add">
<button id="add_customer"   type="button">Add Customer</button>
</>
</table>
 
<script>
function listCustomers() {
  
	$.getJSON("/customer", {"action" : "list",  "directory": "customer_content"}, function(jsonData) {

		var bHeader = true;

		var sourceTable= $( "#customer_table" );
		tr = $('<tr/>');
		tr.append("<th>" + "Click Edit..." + "</th>"); 
		tr.append("<th>" + "Company_name" + "</th>"); 
		tr.append("<th>" + "Contact_name" + "</th>"); 
		tr.append("<th>" + "Personal_title" + "</th>"); 
		tr.append("<th>" + "First_name" + "</th>"); 
		tr.append("<th>" + "Last_name" + "</th>"); 
		tr.append("<th>" + "Phone" + "</th>"); 
		tr.append("<th>" + "Email" + "</th>"); 
		tr.append("<th>" + "Street_addr" + "</th>"); 
		tr.append("<th>" + "City" + "</th>"); 
		tr.append("<th>" + "State" + "</th>"); 
		tr.append("<th>" + "Country" + "</th>"); 
		tr.append("<th>" + "Bill_addr" + "</th>"); 
		tr.append("<th>" + "Ship_addr" + "</th>"); 
		tr.append("<th>" + "Post_code" + "</th>"); 
		sourceTable.append(tr);

		$.each(jsonData.customer ,function(key, value) {
//			if(bHeader){
//				bHeader = false;
//				tr = $('<tr/>');
//				var keys = Object.keys(value);
//				Object.keys(value).forEach(function(k) {
//				  tr.append("<th>" + k + "</th>");});
//				sourceTable.append(tr);
//			}

			tr = $('<tr/>');
                        tr.append("<td>" + "<a href=\"/customer?action=edit&&customer_id=" + value.customer_id +"\"" +">Go...</a>"  + "</td>");
                        tr.append("<td>" + value.company_name + "</td>"); 
                        tr.append("<td>" + value.contact_name + "</td>"); 
                        tr.append("<td>" + value.personal_title + "</td>"); 
                        tr.append("<td>" + value.first_name + "</td>"); 
                        tr.append("<td>" + value.last_name + "</td>"); 
                        tr.append("<td>" + value.phone + "</td>"); 
                        tr.append("<td>" + value.email + "</td>"); 
                        tr.append("<td>" + value.street_addr + "</td>"); 
                        tr.append("<td>" + value.city + "</td>"); 
                        tr.append("<td>" + value.state + "</td>"); 
                        tr.append("<td>" + value.country + "</td>"); 
                        tr.append("<td>" + value.bill_addr + "</td>"); 
                        tr.append("<td>" + value.ship_addr + "</td>"); 
                        tr.append("<td>" + value.post_code + "</td>"); 
			sourceTable.append(tr);
		});
	})
	 .error(function (XMLHttpRequest, textStatus, errorThrown) {
	alert(XMLHttpRequest.responseText);
	});
}


$( document ).ready( function(){
	listCustomers();
});
 
</script>
 
{% include web/footer.html %}
   


